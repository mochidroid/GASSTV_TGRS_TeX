\section{Introduction}
\IEEEPARstart{H}{yperspectral} (HS) imaging measures a wide spectrum of light ranging from the ultraviolet to the near-infrared.
The rich spectral information of HS images, with more than one hundred bands, can distinguish materials and phenomena that the human eye and existing RGB cameras cannot.
This capability has been applied in diverse fields including agriculture, mineralogy, astronomy, and biotechnology~\cite{Borengasser2007HSIApplications,Grahn2007Techniques, Thenkabail2016VegetationOverview,Lu2020AgricultureOverview}.
However, observed HS images are inevitably contaminated by various types of noise---including thermal noise, quantization noise, shot noise, and stripe noise---due to factors caused by measurement equipment and environment, such as photon effects, atmospheric absorption, dark currents, and sensor disturbances~\cite{Shen2015DenoisingOverview,Rasti2018DenoisingOverview,Shen2022DenoisingOverview}.
Since such noise significantly degrades the performance of subsequent processing such as unmixing~\cite{Bioucas-Dias2012UnmixingOverview,Ma2014UnmixingOverview}, classification~\cite{Ghamisi2017Classification,Li2019Classification,Nicolas2019Classification}, and anomaly detection~\cite{Matteoli2014Anomaly,Su2022Anomaly}, HS image denoising is an essential preprocessing step for the applications.


To obtain desirable HS images from degraded observations, HS recovery methods need to employ strategies to capture the inherent properties of HS images. For such strategies, existing methods adopt deep neural networks (DNN) or regularization functions. DNN approaches capture the properties that are difficult to model mathematically or statistically. Various architectures have been proposed, including Convolutional NN (CNN) based methods~\cite{Yuan2019HSIDCNN, Wang2022NL3DCNN} that extract spatial and spectral correlations; recurrent models~\cite{Wei2021QRNN3D} that leverage quasi-recurrent units to learn the global spectral correlations; transformer-based approaches~\cite{Li2023SST} that capture long-range spatial–spectral relationships via self-attention; and DNNs with subspace framework, where denoising is performed in a low-dimensional coefficient space derived from spectral low-rank decomposition~\cite{Zhuang2023FastHyMix, Peng2024RCILD}. However, they do not separate HS images from noise exhibiting similar spatial structures to HS images. For instance, stripe noise is smooth in one spatial direction, and HS images are often smooth in the direction as well. Therefore, when HS images are contaminated by such types of noise, DNN approaches degrade their performance.


On the other hand, since regularization functions are mathematically designed to accurately separate desirable HS images from various types of noise, they have attracted attention~\cite{Xue2017Robust,Jiang2022Adaptive,Naganuma2024Unmixing}. Over the past decade, non-local similarity methods, including 3D Nonlocal Means (3DNLM)~\cite{Qian20123DNLM}, Block Matching 3D Filtering (BM3D)~\cite{Maggioni2013BM3D}, BM4D~\cite{Chen2014BM4D}, and Non-local Meets Global (NGMeet)~\cite{He2019NGmeet} have been proposed to capture similarities in distant patches, but these methods blur edges. In contrast, total variation (TV) type regularization methods originating from edge-preserving natural image denoising~\cite{Rudin1992TV,Bresson2008TV} have been developed. The pioneering TV-type method for HS image denoising is \textit{Spectral-Spatial Adaptive Hyperspectral TV} (SSAHTV)~\cite{Yuan2012HTV}, which models the spatial piecewise-smoothness of HS images as the sparsity of first-order spatial differences between adjacent pixels. Furthermore, \textit{Anisotropic Spectral Spatial TV} (ASSTV)~\cite{Chang2015ASSTV} extends this model by incorporating first-order spectral differences into the SSAHTV regularization function, capturing the spectral piecewise-smoothness in addition to the spatial piecewise-smoothness of HS images. However, HS images are often severely degraded by various types of noise unlike natural images, and under such conditions, because first-order differences cannot sufficiently distinguish noise components from clean image structures, minimizing the $\ell_{1}$-type norms of first-order differences in SSAHTV and ASSTV causes over-smoothing. In addition, since these methods only refer to adjacent pixels/bands, they corrupt edges and textures that extend beyond adjacent pixels during the denoising process.


One promising TV-type regularization method that overcomes blurring and over-smoothing is Spatio-Spectral TV (SSTV)~\cite{Aggarwal2016SSTV}.
SSTV is defined by the $\ell_{1}$ norm of second-order spatio-spectral differences, i.e., first-order spatial differences of spectral ones to avoid over-smoothing.
In addition, SSTV captures not only the spatial piecewise-smoothness, but also the spatial similarity between adjacent bands by its formulation.
For these reasons, SSTV has been widely used in state-of-the-art HS image denoising methods~\cite{Fan2018SSTV-LRTF,Ince2019GLSSTV,Takeyama2020HSSTV,Wang2021l0l1HTV,Takemoto2022GSSTV}.	
Takeyama $\etal$ proposed \textit{Hybrid Spatio-Spectral TV} (HSSTV)~\cite{Takeyama2020HSSTV}, which enhances SSTV by incorporating SSAHTV.
To recover more detailed spatial structures of HS images, \textit{Graph Spatio-Spectral TV} (GSSTV)~\cite{Takemoto2022GSSTV} was proposed, which weights the spatial difference operator of SSTV based on a graph reflecting the spatial structures of an HS image.
To directly control the degree of the smoothness, Wang $\etal$ proposed the $\ell_{0}\text{-}\ell_{1}$ \textit{hybrid TV} ($\llHTV$)~\cite{Wang2021l0l1HTV}, which incorporates $\ell_{0}$-type constraints of the spatial differences (originally proposed for color image processing~\cite{Ono2017l0Gradient}) into SSTV.
However, SSTV and its extension methods cannot preserve the semi-local spatial structures of HS images during the denoising process because they only refer to adjacent pixels/bands.


As an approach to capture non-local properties and potentially solve the corruption of semi-local spatial structures, we focus on low-rank (LR) regularization methods~\cite{Zhang2014LRMR, Chen2022FGSLR}. HS images have strong correlations between vectors for each pixel across all bands, arising from their composition of a limited variety of material-specific spectra. By promoting spectral low-rankness, LR-type regularization methods capture this non-local property rather than the properties of adjacent pixels or bands. However, since LR modeling does not directly account for spatial structures, several works have proposed combining it with TV~\cite{He2016LRTV, Chen2023TPTV}, or applying tensor decomposition techniques~\cite{Xue2022Tensor1,Xue2022Tensor2,Xue2024Tensor}. Tensor decomposition-based methods~\cite{Wang2018LRTDTV, Chen2020LRTDGS, Sun2022Tensor, Li2024LRTDAHL} aim to extract jointly spatial and spectral global latent structures across the three spatial-spectral modes, but they generally do not explicitly characterize local or semi-local spatial structures of HS images.


By integrating the spectral correlation modeling of LR regularization into the TV framework, Structure Tensor Total Variation (STV)~\cite{Lefkimmiatis2015STV, Wu2017STWNNM, Ono2016ASTV, Kurihara2017SSST} has been developed to preserve semi-local spatial structures. These regularization functions evaluate the spectral correlation in differences instead of the sparsity of differences, as in the standard TV-type methods, via the nuclear norm of \textit{structure tensors}\footnote{Following the original STV paper~\cite{Lefkimmiatis2015STV}, we call a 'matrix' composed of differences as structure 'tensor.' The structure tensor is often used in image processing~\cite{Forstner1987Fast, Weickert1998Anisotropic, Jahne2005Digital}.} consisting of matrices of local differences in small spatial areas and all bands. The original STV~\cite{Lefkimmiatis2015STV} and \textit{Structure Tensor total variation-regularized Weighted Nuclear Norm Minimization} (STWNNM)~\cite{Wu2017STWNNM} capture the semi-local spatial piecewise-smoothness, but do not model the spectral property of HS images due to consisting only of spatial differences. The regularization function of \textit{Arranged Structure tensor TV} (ASTV)~\cite{Ono2016ASTV} characterizes the spectral correlations across all bands by modifying the ordering of spatial differences in the structure tensors. In addition, \textit{Spatio-Spectral Structure Tensor} (SSST)~\cite{Kurihara2017SSST} explicitly exploits the spectral piecewise-smoothness of HS images by including not only spatial differences but also spectral ones in its formulation. However, the existing STV-type regularization methods minimize the nuclear norms of “first-order" differences, leading to spatial or spectral over-smoothing, as in SSAHTV.

 
From the discussion so far, SSTV and STV-type regularization methods are powerful approaches that capture the underlying spatial and spectral characteristics of HS images.
However, they have their own limitations: SSTV cannot preserve the semi-local spatial structures and STV-type regularization methods cause over-smoothing.
Now a natural question arises: \textit{Can we design a regularization function with the two requirements: avoid over-smoothing, preserve semi-local spatial structures?} 


Inspired by both SSTV and the above family of STV, we propose a denoising method for HS images using a newly introduced \textit{spatio-spectral structure tensor total variation} ($\SSSTTV$) model.
The main contributions of this article are summarized as follows.
\begin{enumerate}
	\item We design a novel regularization method, namely $\SSSTTV$. 
	This method includes newly designed function defined as the sum of the nuclear norms of structure tensors (called spatio-spectral structure tensor) that include \textit{second-order spatio-spectral differences}. 
	This function can fully capture the spatial piecewise smoothness, the spatial similarity between adjacent bands, and the spectral correlation across all bands in small spatial areas. This leads to effective noise removal while preserving the semi-local spatial structures of HS images without over-smoothing.
	
	\item We formulate the mixed noise removal problem as a constrained convex optimization problem involving $\SSSTTV$. 
	Inspired by the approach of separating noise components~\cite{Zhang2022Double}, our method incorporates specific hard constraints to characterize Gaussian noise, sparse noise, and stripe noise within the optimization problem, enabling effective removal of these noise types from HS images. 
	By using hard constraints instead of data-fidelity and noise terms, we decouple interdependent hyperparameters into independent ones, making parameter setting easier, as shown in prior studies~\cite{Afonso2011Constraint, Chierchia2015Constraint, Ono2015Constraint, Ono2017Constraint, Ono2019Constraint, Naganuma2022Destriping}.

	
	\item To solve our optimization problem for the HS image denoising, we develop an efficient algorithm based on a Preconditioned Primal-Dual Splitting method (P-PDS)~\cite{Pock2011PPDS}. 
	Unlike other popular algorithms used in existing HS image denoising methods, such as an alternating direction method of multipliers~\cite{Boyd2011ADMM} and PDS~\cite{Chambolle2011PDS, Condat2013PDS}, P-PDS can automatically determine the appropriate stepsizes based on the problem structure~\cite{Pock2011PPDS,Naganuma2023PPDS}. 
	
\end{enumerate}
Experimental results show the superiority of the proposed method to existing methods including state-of-the-art ones.
The comparison of the features of the existing and proposed methods is summarized in Table.~\ref{tab:ProsCons}.

The paper is organized as follows.
In Sec.~\ref{sec:Preliminaries}, we introduce the mathematical tools required for the proposed method.
Sec.~\ref{sec:proposed_method} provides the proposed HS image denoising method involving $\SSSTTV$.
The experimental results are reported in Sec.~\ref{sec:experiments}.
Finally, we give concluding remarks in Sec.~\ref{sec:conclusion}.
The preliminary version of this paper, without considering stripe noise, mathematical details, comprehensive experimental comparison, or deeper discussion, has appeared in conference proceedings~\cite{Takemoto2023S3TTV}.

\input{./src_fig/tab_ProsCons}