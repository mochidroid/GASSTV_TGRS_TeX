%\myexternaldocument{main}
%\externaldocument[I-]{main}
\DeclareMathOperator{\Fix}{Fix}
\DeclareMathOperator{\lev}{lev}
\DeclareMathOperator{\prox}{prox}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\inter}{int}
\DeclareMathOperator{\cone}{cone}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\vecop}{vec}
\DeclareMathOperator{\sgn}{sgn}
\newcommand{\argmax}{\mathop{\mathrm{argmax}}\limits}
\newcommand{\argmin}{\mathop{\mathrm{argmin}}\limits}
\newcommand{\minimize}{\mathop{\mathrm{Minimize}}\limits}

\theoremstyle{plain}
\newtheorem{lem}{Lemma}
\newtheorem{thm}{Theorem}


\def\etal{\textit{et al.}}

\def\Order#1{\mathcal{O}(#1)}

\def\InnerProduct<#1>{\langle #1 \rangle}
\def\MatrixBrackets[#1]#2{\lbrack #1 \rbrack_{#2}}
\def\AlgoLfloor#1{\left\lfloor #1 \right}
\def\MatrixIdentity{\mathbf{I}}
\def\MatrixZero{\mathbf{O}}
\def\OpNorm#1{\| #1 \|_{\mathrm{op}}}
\def\OpNormSq#1{\| #1 \|_{\mathrm{op}}^{2}}

\def\llHTV{{l_{0}\text{-}l_{1}\text{HTV}}}

\def\RealSpace#1{\mathbb{R}^{#1}}
\def\SetProperLowerConvex#1{\Gamma_{0}(#1)}
\def\SetConvex{C}
\def\FuncIndicator#1{\iota_{#1}}

\def\Projection#1{P_{#1}}


% General variables
\def\FuncOne{f}
\def\FuncTwo{g}
\def\NumVarOne{N}
\def\NumVarTwo{M}
\def\VarOne{\mathbf{x}}
\def\VarTwo{\mathbf{y}}
\def\MatrixOne{\mathbf{X}}
\def\ElementOne#1{x_{#1}}
\def\IndexOne{i}


% HSI and related 
\def\HSIClean{\mathbf{u}}
\def\HSIObsv{\mathbf{v}}
\def\NoiseSparse{\mathbf{s}}
\def\NoiseGauss{\mathbf{n}}
\def\NoiseStripe{\mathbf{t}}

\def\ResHSIClean{\HSIClean^{'}}
\def\ResNoiseSparse{\NoiseSparse^{'}}
\def\ResNoiseStripe{\NoiseStripe^{'}}

% \def\NumPixel{N}
\def\NumAll{N}
\def\NumVert{N_{1}}
\def\NumHori{N_{2}}
\def\NumBand{N_{3}}



\def\NumSingularValue{Q}


\def\IndexAlg{t}

% 2.1 Notation
\def\NotationVector{\mathbf{x}}
\def\NotationMatrix{\mathbf{X}}
\def\NotationScalar{x}
\def\NotationNumDim{N}
\def\NotationIndex{n}

% 2.2 Proximal Tools
\def\FuncProx{\FuncOne}
\def\IndexProx{\gamma}
\def\VarProxOne{\VarOne}
\def\VarProxTwo{\VarTwo}
\def\NumVarProx{\NumVarOne}
\def\ScalarProx{\delta}
\def\MatrixProx{\mathbf{G}}
\def\Projection#1{P_{#1}}


% 2.3 P-PDS
\def\FuncPrimal#1{\FuncOne_{#1}}
\def\FuncDual#1{\FuncTwo_{#1}}
\def\VarPrimal#1{\VarOne_{#1}}
\def\VarDual#1{\VarTwo_{#1}}
\def\VarDualMatrix#1{\mathbf{Y}_{#1}}

\def\NumVarPrimal{\NumVarOne}
\def\NumVarDual{\NumVarTwo}
\def\DimVarPrimal#1{n_{#1}}
\def\DimVarDual#1{m_{#1}}
\def\IndexPrimal{i}
\def\IndexDual{j}
\def\IndexVarPrimal{k}
\def\IndexVarDual{l}

\def\LinOpPPDS#1{\mathbf{A}_{#1}}
\def\ScalarStepsize#1{\gamma_{#1}}
\def\MatrixStepsize#1{\mathbf{\Gamma}_{#1}}
% \def\ParamStepsize#1{\mathbf{\Gamma}_{#1}}
\def\ParamStepsize#1{\gamma_{#1}}
\def\ASPrimal#1{\sigma_{#1}}
\def\ASDual#1{\tau_{#1}}

% \def\OpNormUp#1{\mu_{#1}}
\def\OpNormUp#1{\xi_{#1}}

\def\ConstantRow#1{c_{1, #1}}
\def\ConstantColumn#1{c_{2, #1}}


% 2.5 Spatial Graph by GSSTV
\def\GuideImage{\HSIObsv{'}}
\def\GuideImageVec{v{'}}
\def\IndexVert{i}
\def\IndexHori{j}
\def\IndexBand{c}

\def\SpatialGraph{\mathcal{G}_{\text{sp}}}
\def\SpatialGraphEdgeSet{\mathcal{E}_{\text{sp}}}
\def\SpatialGraphWeightMat{\mathbf{W}_{\text{sp}}}
\def\IndexEdgeOne{p}
\def\IndexEdgeTwo{q}
\def\SpatialGraphEdge{e_{\IndexEdgeOne, \IndexEdgeTwo}}
\def\NumSpatialGraphEdge{|\SpatialGraphEdgeSet|}
\def\SpatialGraphWeight{w_{\SpatialGraphEdge}}
\def\ParamSpatialGraph{\sigma_{\text{sp}}}


\def\SpatialGraphIncidenceMat{\mathbf{D}}
\def\DiffOpGraphSp{\mathbf{D}_{\SpatialGraph}}



% 3.1 Weighted Spectral Difference Operator based on Spectral Graph
\def\IndexSegment{k}
\def\NumSegment{K}
\def\Segment#1{\mathcal{S}_{#1}}
\def\LabelMap{\mathbf{L}}
\def\SpectrumRep#1{\mathbf{r}_{#1}}

\def\SpectralGraph{\mathcal{G}_{\lambda}}
\def\SpectralGraphNode{\mathbf{x}_{\lambda}}
\def\SpectralGraphEdgeSet{\mathcal{E}_{\lambda}}
\def\SpectralGraphWeightMat{\mathbf{W}_{\lambda}}
\def\SpectralGraphWeight#1{w_{#1}}
\def\IndexWeight{\IndexBand}
\def\ParamSpectralGraph{\sigma_{\lambda}}

\def\DiffOpGraphBand{\mathbf{D}_{\SpectralGraph}}


% 3.2 GASSTV
\def\GASSTV{\text{GASSTV}}

\def\DiffOpVert{\mathbf{D}_{\text{v}}}
\def\DiffOpHori{\mathbf{D}_{\text{h}}}
\def\DiffOpBand{\mathbf{D}_{\lambda}}
\def\DiffOpSp{\mathbf{D}_{\text{vh}}}

\def\DiffOpVertT{\DiffOpVert^{\top}}
\def\DiffOpHoriT{\DiffOpHori^{\top}}
\def\DiffOpBandT{\DiffOpBand^{\top}}
\def\DiffOpSpT{\DiffOpSp^{\top}}


\def\DiffOpGraphSpT{\DiffOpGraphSp^{\top}}
\def\DiffOpGraphBandT{\DiffOpGraphBand^{\top}}

\def\BalanceParamOne{\omega_{1}}
\def\BalanceParamTwo{\omega_{2}}



% 3.2 HSI Denoising Problem
\def\RadiusFidel{\varepsilon}
\def\RadiusSparse{\alpha}
\def\RadiusStripe{\beta}

\def\ParamsRadius{\rho}

\def\BallFidel{B_{2, \RadiusFidel}^{\HSIObsv}}
\def\BallSparse{B_{1, \RadiusSparse}}
\def\BallStripe{B_{1, \RadiusStripe}}
\def\SetZero{\{ \mathbf{0} \}}

\def\MinRange{\underline{\mu}}
\def\MaxRange{\bar{\mu}}
% \def\MinRange{\underline{\xi}}
% \def\MaxRange{\bar{\xi}}
\def\SetRange{R_{\MinRange,\MaxRange}}

\def\OperationVec{\VarOne}
\def\OperationMatrix{\MatrixOne}
% \def\SetProb{S}
% \def\BallFidel{\SetProb_{\ell_{2}}^{(\HSIObsv, \RadiusFidel)}}
% \def\BallSparse{\SetProb_{\ell_{1}}^{(\mathbf{0}, \RadiusSparse)}}
% \def\BallStripe{\SetProb_{\ell_{1}}^{(\mathbf{0}, \RadiusStripe)}}
% \def\SetZero{\{ \mathbf{0} \}}

% \def\MinRange{\underline{\mu}}
% \def\MaxRange{\bar{\mu}}
% \def\SetRange{\SetProb_{\lbrack \MinRange,\MaxRange \rbrack}}

\def\IndexVert{i}
\def\IndexHori{j}


% 4.1 Simulated HS Image Data Experiment


\def\StanDevGauss{\sigma}
\def\RateSparse{p_{\NoiseSparse}}
\def\RateStripe{p_{\NoiseStripe}}

\def\IndexNoisy{\text{(b)}}
\def\IndexSSTV{\text{(c)}}
\def\IndexHSSTVOne{\text{(d)}}
\def\IndexHSSTVTwo{\text{(e)}}
\def\IndexllHTV{\text{(f)}}
\def\IndexGSSTV{\text{(g)}}
\def\IndexGASSTV{\text{(h)}}


